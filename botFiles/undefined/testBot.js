var canvasTiles=document.getElementById("tiles"),contextTiles=canvasTiles.getContext("2d"),canvasBombs=document.getElementById("bombs"),contextBombs=canvasBombs.getContext("2d"),canvasPlayerOne=document.getElementById("player-one"),contextPlayerOne=canvasPlayerOne.getContext("2d"),canvasPlayerTwo=document.getElementById("player-two"),contextPlayerTwo=canvasPlayerTwo.getContext("2d"),canvasPlayerThree=document.getElementById("player-three"),contextPlayerThree=canvasPlayerTwo.getContext("2d"),canvasPlayerFour=document.getElementById("player-four"),contextPlayerFour=canvasPlayerTwo.getContext("2d"),matrix={},matrixSize=9,brickSize=64,upperLimit=matrixSize-1,upperLimitMinusOne=upperLimit-1,empty=["0 0",upperLimit+" 0","0 "+upperLimit,upperLimit+" "+upperLimit,"1 0",upperLimitMinusOne+" 0","0 "+upperLimitMinusOne,upperLimit+" "+upperLimitMinusOne,"0 1",upperLimit+" 1","1 "+upperLimit,upperLimitMinusOne+" "+upperLimit],iconBomb=new Image,patternBrick=new Image,patternPillar=new Image,patternFloor=new Image,patternFire=new Image,playerBirdie=new Image,playerElephant=new Image,playerFishy=new Image,playerMonkey=new Image,playerRam=new Image,playerOx=new Image,playerPiggle=new Image,playerWhale=new Image,BOMB_TIMER=5e3,BOMB_CLEAR_TIMER=400,gameId,gameOn=!1,frozen=!1,startTimer=3e3,movementDelay=100,movementTimer,controlsBound=!1,player,players=[],avatars={birdie:playerBirdie,elephant:playerElephant,fishy:playerFishy,monkey:playerMonkey,ram:playerRam,ox:playerOx,piggle:playerPiggle,whale:playerWhale},playerMap=[{context:contextPlayerOne,x:0,y:0},{context:contextPlayerTwo,x:upperLimit,y:0},{context:contextPlayerThree,x:0,y:upperLimit},{context:contextPlayerFour,x:upperLimit,y:upperLimit}];function Player(i,t,s){this.context=i,this.name=t||"Whale",this.avatar=s||playerWhale,this.isAlive=!0,this.position={},this.maxBombs=1,this.bombs=0,this.move=function(i){if(this.isAlive&&this.canGo(i,this.position))switch(i){case"up":this.render(this.position.x,this.position.y-1);break;case"down":this.render(this.position.x,this.position.y+1);break;case"left":this.render(this.position.x-1,this.position.y);break;case"right":this.render(this.position.x+1,this.position.y)}},this.canGo=function(i,t){var s=t.x,e=t.y;switch(i){case"up":e=t.y-1;break;case"down":e=t.y+1;break;case"left":s=t.x-1;break;case"right":s=t.x+1}var o=getTile(s,e);return o&&o.canMove&&!o.hasBomb},this.clearBomb=function(){this.bombs--},this.plantBomb=function(){if(this.isAlive&&!(this.bombs>=this.maxBombs||getTile(this.position.x,this.position.y).hasBomb)){new Bomb(this.position.x,this.position.y);this.bombs++,setTimeout(this.clearBomb.bind(this),BOMB_TIMER),Bomb.plant(this.position.x,this.position.y),socket&&player&&socket.emit("bomb",gameId,this.position)}},this.render=function(i,t,s){this.context.clearRect(this.position.x*brickSize,this.position.y*brickSize,brickSize,brickSize),this.isAlive&&(this.context.drawImage(this.avatar,i*brickSize,t*brickSize,brickSize,brickSize),this.position.x=i,this.position.y=t,socket&&player&&!s&&socket.emit("move",gameId,player.id,this.position))},this.remove=function(){this.context.clearRect(0,0,brickSize*matrixSize,brickSize*matrixSize)}}function Bomb(i,t,s){this.position={x:i,y:t},this.isAlive=!0,this.strength=s||1,this.blown=[],this.powerUp=function(){this.strength++},this.cleanUp=function(){this.blown.forEach(function(i){contextBombs.clearRect(i.x*brickSize,i.y*brickSize,brickSize,brickSize);var t=getTile(i.x,i.y);updateTile(i.x,i.y,"type","empty"),updateTile(i.x,i.y,"canMove",!0),t.render(t.position.x,t.position.y)})},this.detonate=function(){clearTimeout(this.explosionTimer),this.isAlive=!1,contextBombs.fillStyle="rgb(231, 76, 60)",updateTile(this.position.x,this.position.y,"hasBomb",!1),[{x:this.position.x,y:this.position.y},{x:this.position.x,y:this.position.y-this.strength},{x:this.position.x,y:this.position.y+this.strength},{x:this.position.x-this.strength,y:this.position.y},{x:this.position.x+this.strength,y:this.position.y}].forEach(function(i){this.canExplode(i.x,i.y)&&(this.blown.push({x:i.x,y:i.y}),updateTile(i.x,i.y,"canMove",!1),contextBombs.drawImage(patternFire,i.x*brickSize,i.y*brickSize,brickSize,brickSize))},this),setTimeout(this.cleanUp.bind(this),BOMB_CLEAR_TIMER)},this.canExplode=function(i,t){var s=getTile(i,t);return s&&s.canExplode},this.render=function(){if(this.isAlive){if(contextBombs.clearRect(this.position.x*brickSize,this.position.y*brickSize,brickSize,brickSize),contextBombs.drawImage(iconBomb,this.position.x*brickSize,this.position.y*brickSize,brickSize,brickSize),updateTile(this.position.x,this.position.y,"hasBomb",!0),this.explosionTimer)return;this.explosionTimer=setTimeout(this.detonate.bind(this),BOMB_TIMER)}}}Player.create=function(i,t){var s=new Player(i,t.name,avatars[t.avatar]);return s.id=t.id,s.index=t.index,s.ready=t.ready,s},Bomb.plant=function(i,t){contextBombs.clearRect(i*brickSize,t*brickSize,brickSize,brickSize),contextBombs.drawImage(iconBomb,i*brickSize,t*brickSize,brickSize,brickSize)};var player = new Player(null, "test", null);
function exec(){
  var nb=Math.floor((Math.random() * 100) + 1);
  if(nb>0 && nb<20){
        player.move("left")
    player.plantBomb()
      player.move("right")
      player.move("down")
  }else if(nb>20 && nb<40){
      player.move("right")
  }else if(nb>40 && nb<60){
      player.move("left")
  }else if(nb>60 && nb<80){
      player.move("down")
  }else if(nb>80 && nb<100){
      player.move("up")
  }


}

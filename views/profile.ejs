<!-- views/profile.ejs -->
<!doctype html>
<html>
<head>
    <title>Profil</title>
    <% include ./partials/header %>
</head>
<body class="bomber-background">
<% include ./partials/navbar %>

<div class="container">
    <div class="col-sm-8 col-sm-offset-2 bomber-block bomber-text">
        <%profile = JSON.parse(profile)
        var winTotal = 0;%>

        <h2 class="bomber-text"><span class="fa fa-user-circle"></span> Profil de <b class="bomber-bold"><%=profile.loginUser%></b></h2>
        <hr class = "bomber-line" >
        <div class="row">
            <div class="col-sm-8">
                <p class="bomber-text"><span class="fa fa-envelope-o"></span> Email : <a href="mailto:<%=profile.emailUser%>"><%=profile.emailUser%></a></p>
                <p class="bomber-text"><span class="fa fa-pencil-square-o"></span> Inscrit le <%=profile.createdAt.substring(8,10)%>/<%=profile.createdAt.substring(5,7)%>/<%=profile.createdAt.substring(0,4)%></p>
                <%if (session.idUser == profile.idUser) {%>
                    <p><a class="btn btn-lg bomber-btn" href = "/updateUser/<%=profile.idUser%>"> Modifier</a></p>
                <%}%>
            </div>
            <div class="col-sm-4 hidden-xs">
                <img src="/images/bomber-profile.png" style ="width:100%;"/>
            </div>
        </div>

        <%
        if (listBot.length > 0) {
        if (listBot[0].userIdBot) {
            var win = 0;
            var lose = 0;
            for (var i = 0 ; i < listBot.length ; i++) {
                win += listBot[i].winBot;
                lose += listBot[i].loseBot;
            }
            winTotal = win;
            var total = win + lose;
            var victory = (win / total) * 100;
            var defeat = (lose / total) * 100;
            var ratio = 0;
            if ( lose > 0) {
                ratio = (win / lose).toFixed(2);
            } %>
        <div class="row" style="margin: 5px">
            <h4 class="bomber-text"><span class="fa fa-bar-chart"></span> Statistique</h4>
            <div style="text-align: center">
                <p><b class="bomber-bold">Nombre de partie : <%=total%> joué</b></p>
            </div>
            <div class="progress" style="margin: 15px">
                <div class="progress-bar progress-bar-success"  style="width: <%=victory%>%"> V <%=win%>
                </div>
                <div class="progress-bar progress-bar-danger" style="width: <%=defeat%>%"> D <%=lose%>
                </div>
            </div>
            <div style="text-align: center">
                <p><b class="bomber-bold">Ratio : <%=ratio%></b></p>
            </div>
        </div>
        <%
        }
        }
        %>
        <div class="row" style="margin: 5px">
            <h4 class="bomber-text"><span class="fa fa-trophy"></span> Trophées</h4>

            <%
            if (winTotal > 0) {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-1.png" alt="Image 1" />
            </div>
            <% } else {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-lock.jpg" alt="Image 1" />
            </div>
            <%}%>

            <%if (winTotal > 4) {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-5.png" alt="Image 1" />
            </div>
            <% } else {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-lock.jpg" alt="Image 1" />
            </div>
            <%}%>

            <%if (winTotal > 9) {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-10.png" alt="Image 1" />
            </div>
            <% } else {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-lock.jpg" alt="Image 1" />
            </div>
            <%}%>

            <%if (winTotal > 24) {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-25.png" alt="Image 1" />
            </div>
            <% } else {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-lock.jpg" alt="Image 1" />
            </div>
            <%}%>

            <%if (winTotal > 49) {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-50.png" alt="Image 1" />
            </div>
            <% } else {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-lock.jpg" alt="Image 1" />
            </div>
            <%}%>

            <%if (winTotal > 99) {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-100.png" alt="Image 1" />
            </div>
            <% } else {%>
            <div class="col-xs-2 bomber-trophy">
                <img src="/images/trophy-lock.jpg" alt="Image 1" />
            </div>
            <%}%>
        </div>
    </div>
</div>
<% include ./partials/footer %>
</body>
</html>